# Gomorrah C2 Panel

In this blog post we will look at the malware Command and Control (C2) panel.  Please read the [**previous blog post on dynamic analysis of the malware.**](https://github.com/SecDSM/malware_writeups/blob/master/20200508_Gomorrah_Stealer/Dynamic_Analysis/Gomorrah_Stealer.md)

## Panel Login

We observed there was a panel located at the following location:

`hXXp://florapansiyonotel[.]com/images/jaf3/Panel/login.php`

URLscan.io Link of Panel: 

https://urlscan.io/result/20acf1b5-45cf-4faa-b12c-356f7d937183/

![Gomorrah Web Panel Login](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/1.png)

## Bot Information Page

After the attacker logs into the C2 panel, they are greeted with the following:

![Gomorrah Bot Information Page](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/2.png)

Clicking the admin icon in the top right of the panel opens the following:

![Gomorrah Admin Page](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/3.png)

We assume clicking the Recycle Bin icon deletes the compromised host from the database.

![Gomorrah Bot Information Page](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/4.png)

The Next and Prev icons scroll through the different pages of bots.

## Uploaded Files

Clicking the Folder icon under the Action column of the original bot control page opens the following page:

![Gomorrah Stolen Files](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/5.png)

The CC.txt file contains credit card information stolen from web browsers on the compromised system.  

The Databases directory contains database files.

![Gomorrah Databases](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/6.png)

The Documents directory are documents that were on the local system of the compromised host.

![Gomorrah Documents](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/7.png)

The Passwords.txt file contains the browser(s) and Outlook passwords from the compromised system.

The Photos directory contains photos that were on the compromised system.

![Gomorrah Photos](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/8.png)

The Screenhot directory contains screenshots that were taken when the malware was executed on the compromised system.

![Gomorrah Screenhot](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/9.png)

The TXT directory contains text and log files from the compromised system.

![Gomorrah TXT](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/10.png)

Finally, the info.txt file contains the system information of the compromised system.

![Gomorrah info.txt](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/11.png)

## Pivoting

We noticed a picture with the filename “wild_olivia.png” on the panel login page.  Pivoting from that file through URLscan.io we were able to observe other Gomorrah and Lucifer panels.

https://urlscan.io/search/#filename:%22wild_oliva.png%22

URLscan.io hash searches to identify other Gomorrah (and Lucifer) C2 Panels:
https://urlscan.io/search/#hash%3A4ab0985edd411d4839e5eac829ff0bed02397351758133532ba86169842fef47

https://urlscan.io/search/#hash%3A51e8181d2c98bf2b7a4f4023f6e2835515e3431323b1dcc93b13676859d44ed9

With the earliest Gomorrah panel being scanned on March 22nd 2020, 11:31:25 am.

`hXXp://hojokk[.]com/0x//Panel/login.php`

https://urlscan.io/result/657ca283-76d0-4f32-90c3-63c0da4b5e40/

List of other Gomorrah Panels from URLscan.io:

```
hXXp://hojokk[.]com/0x//Panel/login.php
hXXp://freycinetvista.com[.]au/oo/webpanel/Panel/login.php
hXXp://florapansiyonotel[.]com/images/jaf3/Panel/login.php
hXXp://rajas.com[.]my/js/10/webpanel/Panel/login.php
hXXp://193[.]142.59.18/gon0/1/Panel/login[.]php
 
95[.]163.180.192
103[.]19.171.204
185[.]81.153.102
103[.]6.198.93
193[.]142.59.18
```

We observed a Lucifer panel hosted on one of these domains as well.

`hXXp://rajas.com[.]my/wp-content/uploads/2015/nux/Panel/lucifer/Panel/login.php`

https://urlscan.io/result/f5133a15-75cf-4010-84f1-482257191981/

![Lucifer Panel Login](/20200508_Gomorrah_Stealer/Gomorrah_C2_Panel/images/12.png)

## IOCs

Domain(s):

hojokk[.]com

freycinetvista[.]com[.]au

florapansiyonotel[.]com

rajas[.]com[.]my

turasogutmas[.]com

www[.]espadaeoliveira[.]com

tinuthomas[.]com

URL(s):

hXXp://hojokk[.]com/0x//Panel/login.php

hXXp://freycinetvista.com[.]au/oo/webpanel/Panel/login.php

hXXp://florapansiyonotel[.]com/images/jaf3/Panel/login.php

hXXp://rajas.com[.]my/js/10/webpanel/Panel/login.php

hXXp://rajas.com[.]my/js/9/webpanel/Panel/login.php

hXXp://rajas.com[.]my/js/8/webpanel/Panel/login.php

hXXp://rajas.com[.]my/js/3/webpanel/Panel/login.php

hXXp://rajas.com[.]my/js/2/webpanel/Panel/login.php

hXXp://rajas.com[.]my/js/1/webpanel/Panel/login.php

hXXp://193[.]142.59.18/gon0/1/Panel/login[.]php

hXXp://turasogutmas[.]com/lucifer/lucifer/Panel/login.php - Lucifer

hXXp://rajas.com[.]my/wp-content/uploads/2015/nux/Panel/lucifer/Panel/login.php - Lucifer

hXXp://www.espadaeoliveira[.]com/css/lucifer/Panel/login.php - Lucifer

hXXp://tinuthomas[.]com/wp-admin/css/upload/Panel/lucif/Panel/login.php


IP Address(es):

95[.]163.180.192

103[.]19.171.204

185[.]81.153.102

193[.]142.59.18

103[.]6.198.93 - Lucifer and Gomorrah

89[.]208.210.190 - Lucifer

94[.]46.23.210 - Lucifer

131[.]153.37.3 - Lucifer

## Notes
We observed different HTTP status codes based on whether the file(s) were accessible.  We assume this is because of the htaccess file and not being authenticated to the panel.

## Credits

The following people contributed to the analysis of this sample:

[**mattdep_**](https://twitter.com/mattdep_)

[**zoomequipd**](https://twitter.com/zoomequipd)

[**_Romans6_**](https://twitter.com/_Romans6_)

[**leabhart**](https://twitter.com/leabhart)

[**morbitcuriosity**](https://twitter.com/morbitcuriosity)

[**IAEspy**](https://twitter.com/IAEspy)

[**CC_DKP**](https://twitter.com/CC_DKP)